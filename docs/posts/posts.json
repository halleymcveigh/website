[
  {
    "path": "posts/2022-03-12-text-analysis/",
    "title": "Text analysis",
    "description": "An analysis of Braiding Sweetgrass by Robin Wall Kimmerer.",
    "author": [
      {
        "name": "Halley McVeigh",
        "url": {}
      }
    ],
    "date": "2022-03-12",
    "categories": [],
    "contents": "\r\n\r\n\r\nhide\r\n\r\nknitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)\r\n\r\n# packages to attach\r\nlibrary(tidyverse)\r\nlibrary(tidytext)\r\nlibrary(textdata)\r\nlibrary(pdftools)\r\nlibrary(ggwordcloud)\r\nlibrary(here)\r\nlibrary(wesanderson)\r\n\r\n\r\n\r\nOverview:\r\nBraiding Sweetgrass: Indigenous Wisdom, Scientific Knowledge and the Teachings of Plants is a nonfiction book by Robin Wall Kimmerer, an enrolled member of the Citizen Potawatomi Nation and a professor at SUNY-ESF. In this book she explores the relationships between humans and land and the roles that both Indigenous knowledge and Western scientific approaches play in understanding and appreciating these relationships. Kimmerer describes the book as “an invitation to celebrate the gifts of the earth.”\r\nThe following is an exploration of the text in Braiding Sweetgrass with visual representations of trends, patterns, and sentiments.\r\n\r\nTop 100 words in Braiding Sweetgrass\r\n\r\n\r\nhide\r\n\r\n# Read in the data from pdf\r\nbraiding_sweetgrass <- pdf_text(here(\"files\", \"braiding_sweetgrass.pdf\"))\r\n\r\n# Wrangle the text\r\nbraiding_lines <- data.frame(braiding_sweetgrass) %>% \r\n  mutate(page = 1:n()) %>% \r\n  mutate(text_full = str_split(braiding_sweetgrass, pattern = '\\\\n')) %>% \r\n  unnest(text_full) %>% \r\n  mutate(text_full = str_trim(text_full))\r\n\r\nbraiding_tidy <- braiding_lines %>%\r\n  slice(-(1:194)) %>% \r\n  unnest_tokens(word, text_full, token = \"words\") %>% \r\n  select(page, word)\r\n\r\n# Remove stop words\r\nbraiding_words_clean <- braiding_tidy %>% \r\n  anti_join(stop_words, by = 'word')\r\n\r\n# Count words\r\nword_counts <- braiding_words_clean %>% \r\n  count(word)\r\n  \r\n# Find the top 100 words \r\ntop100_words <- word_counts %>% \r\n  arrange(-n) %>% \r\n  slice(1:100)\r\n\r\npalette <- wes_palette(\"Cavalcanti1\", 4, type = \"continuous\")\r\n\r\n# Make a wordcloud\r\nwordcloud <- ggplot(data = top100_words, aes(label = word)) +\r\n  geom_text_wordcloud(aes(color = n, size = n), shape = 'circle') +\r\n  scale_size_area(max_size = 10) +\r\n  scale_color_gradientn(colors = palette) +\r\n  theme_minimal() +\r\n  labs(title = \"Braiding Sweetgrass Word Cloud\")\r\n\r\nwordcloud\r\n\r\n\r\n\r\n\r\nFigure 1. Wordcloud displaying the top 100 words used in Braiding Sweetgrass. Stop words (as, the, if, and etc.) were removed.\r\n\r\nA sentiment analysis with the NRC lexicon\r\nThe NRC Emotion Lexicon is a compiled list of English words and their associated emotion, from eight basic emotions (anger, fear, anticipation, trust, surprise, sadness, joy, and disgust) or sentiment (positive and negative).\r\n\r\n\r\nhide\r\n\r\nbraiding_nrc <- braiding_words_clean %>% \r\n  inner_join(get_sentiments(\"nrc\"))\r\n\r\nbraiding_nrc_counts <- braiding_nrc %>% \r\n  count(page, sentiment)\r\n\r\npalette10 = wes_palette(\"Cavalcanti1\", 10, type = \"continuous\")\r\n\r\nggplot(data = braiding_nrc_counts, aes(x = page, y = n)) +\r\n  geom_col(aes(fill = sentiment), show.legend = FALSE) +\r\n  scale_fill_manual(values = rev(palette10)) +\r\n  facet_wrap(~sentiment) +\r\n  coord_flip() +\r\n  theme_minimal() +\r\n  labs(y = \"Word count\", x = \"Page number\", title = \"Sentiment analysis of Braiding Sweetgrass using the NRC lexicon\")\r\n\r\n\r\n\r\n\r\nFigure 2. Plots faceted by sentiments of Braiding Sweetgrass using the NRC lexicon by word count and page number. Stop words (as, the, if, and etc.) were removed.\r\n\r\n\r\nhide\r\n\r\nggplot(data = braiding_nrc_counts, aes(y = sentiment, x = n)) +\r\n  geom_col(aes(fill = sentiment),show.legend = FALSE) +\r\n  scale_fill_manual(values = rev(palette10)) +\r\n  theme_minimal() +\r\n  labs(x = \"Word count\", y = \"Sentiment\", title = \"Sentiment analysis of Braiding Sweetgrass using the NRC lexicon\")\r\n\r\n\r\n\r\n\r\nFigure 3. Column graph showcasing the words of Braiding Sweetgrass subdivided into sentiments using the NRC lexicon. Stop words (as, the, if, and etc.) were removed.\r\n\r\nData citation:\r\nKimmerer, Robin Wall. 2013 Braiding Sweetgrass. Minneapolis, MN: Milkweed Editions.\r\nFor NRC lexicon: Crowdsourcing a Word-Emotion Association Lexicon, Saif Mohammad and Peter Turney, Computational Intelligence, 29 (3), 436-465, 2013.\r\n\r\n\r\n\r\n",
    "preview": "posts/2022-03-12-text-analysis/text-analysis_files/figure-html5/unnamed-chunk-1-1.png",
    "last_modified": "2022-03-12T13:36:34-08:00",
    "input_file": {}
  },
  {
    "path": "posts/2022-03-12-willamette-falls-fish-passage-time-series-summary/",
    "title": "Willamette Falls fish passage time series summary",
    "description": {},
    "author": [
      {
        "name": "Halley McVeigh",
        "url": {}
      }
    ],
    "date": "2022-03-12",
    "categories": [],
    "contents": "\r\n\r\n\r\nhide\r\n\r\nknitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)\r\n\r\n# Packages to attach\r\n\r\nlibrary(prettydoc)\r\nlibrary(here)\r\nlibrary(tidyverse)\r\nlibrary(wesanderson)\r\nlibrary(janitor)\r\nlibrary(tsibble)\r\nlibrary(feasts)\r\nlibrary(lubridate)\r\nlibrary(patchwork)\r\nlibrary(slider)\r\n\r\n\r\n\r\nOverview:\r\nThis report explores and visualizes data for adult fish passage at the Willamette Falls fish ladder on the Willamette River, Oregon from January 1, 2001 to December 31, 2010. The species included in this dataset are Coho, Jack coho, and Steelhead. The three tabs include visualizations for fish counts across various time periods. Data are recorded and made accessible by the Columbia River DART project.\r\n\r\nSalmon leaping at Willamette Falls (Image source: NOAA Photo)Accessed from: Image source\r\n\r\nMap of the Willametter River Basin showing tributaries and dams (Figure source: Willamette Project Biological Opinion (NMFS 2008))Accessed from: Image source\r\n\r\nLocation of the Willamette Falls (Map source: US Army Corps of Engineers, Portland Distric)Accessed from: Image source\r\n\r\n\r\nhide\r\n\r\nfish_passage <- read_csv(here(\"data\", \"willamette_fish_passage.csv\")) %>% \r\n  clean_names()\r\n\r\n\r\n\r\nData citation:\r\nData shared by and accessed from Columbia River DART. Data Courtesy of U.S. Army Corps of Engineers, NWD and Chelan, Douglas, and Grant County PUDs, Yakima Klickitat Fisheries Project, Colville Tribes Fish & Wildlife (OBMEP), Oregon Department of Fish & Wildlife, Washington Department of Fish & Wildlife.\r\nData Analysis\r\n\r\n\r\nhide\r\n\r\nfish_tidy <- fish_passage %>% \r\n   pivot_longer( # tidies data by consolidating species into one column called species\r\n    cols = c(steelhead, coho, jack_coho),\r\n    names_to = \"species\",\r\n    values_to = \"fish_count\"\r\n  ) %>% \r\n  mutate(date = mdy(date)) %>% # converts date to y-m-d format\r\n  select(date, species, fish_count) %>% # retains only date, species, and fish_count variables\r\n  mutate(species_name = case_when( # creates new column with species' full names\r\n    species == \"coho\" ~ \"Coho\",\r\n    species == \"jack_coho\" ~ \"Jack Coho\",\r\n    species == \"steelhead\" ~ \"Steelhead\"\r\n  )) %>% \r\n  replace_na(list(fish_count = 0)) %>% \r\n  filter(fish_count >= 0) # drop negative counts\r\n\r\nfish_ts <- fish_tidy %>% \r\n  as_tsibble(key = species, index = date) # converts data to tsibble\r\n\r\n\r\n\r\nOriginal time series\r\n\r\n\r\nhide\r\n\r\n#time series plot of adult passage for coho, jack coho, and steelhead.\r\n\r\ncoho_ts <- fish_ts %>% \r\n  filter(species == \"coho\")\r\n\r\njack_ts <- fish_ts %>% \r\n  filter(species == \"jack_coho\")\r\n\r\nsteelhead_ts <- fish_ts %>% \r\n  filter(species == \"steelhead\")\r\n\r\ncoho_ts_plot <- ggplot(data = coho_ts, aes(x = date, y = fish_count)) +\r\n  geom_line(color = \"coral4\") +\r\n  scale_x_date(breaks = \"1 year\", date_labels = \"%Y\") +\r\n  labs(y = \"Count\", x = \"\", title = \"Coho\") +\r\n  theme_minimal()\r\n\r\n#coho_ts_plot\r\n\r\njack_ts_plot <- ggplot(data = jack_ts, aes(x = date, y = fish_count)) +\r\n  geom_line(color = \"brown1\") +\r\n  scale_x_date(breaks = \"1 year\", date_labels = \"%Y\") +\r\n  labs(y = \"Count\", x = \"\", title = \"Jack coho\") +\r\n  theme_minimal()\r\n\r\nsteelhead_ts_plot <- ggplot(data = steelhead_ts, aes(x = date, y = fish_count)) +\r\n  geom_line(color = \"steelblue4\") +\r\n  scale_x_date(breaks = \"1 year\", date_labels = \"%Y\") +\r\n  labs(y = \"Count\", x = \"\", title = \"Steelhead\") +\r\n  theme_minimal()\r\n\r\ncomp_plot <- coho_ts_plot / jack_ts_plot / steelhead_ts_plot + plot_annotation(tag_levels = \"a\", tag_suffix = \")\")\r\n\r\ncomp_plot\r\n\r\n\r\n\r\n\r\nFigure 1: Figure 1: a) Total daily number of adult Coho salmon passages observed at Willamette Falls b) Total daily observed passages of Jack coho (Coho sized 12-18 cm, usually 2 years of age) at Willamette River c) Total number of adult Steelhead passages including both wild and hatchery. (Data: Columbia River DART)\r\n\r\n\r\n\r\nOf the three salmonids, Steelhead are the most abundant in counts in this dataset for the Willamette River fish ladder. There is seasonality in the passage of Steelhead, while not all years are consistent in counts.\r\nThe seasonality of Coho and Jack coho is different than for Steelhead. Coho peak at the end of the year, whereas Steelhead is higher in the spring and summer months. Their counts are not consistent across the years. Counts were higher in the last two years of the data collection for Coho. Jack Coho have the overall lowest counts, which due to their classification of early returning salmon makes sense that they are not aas abundant.\r\nSeasonplots\r\n\r\n\r\nhide\r\n\r\n#scan_gaps(fish_ts)\r\n\r\nseasons_subset <- subset(fish_ts, select = -species)\r\n\r\nseasons_plot <- seasons_subset %>%\r\n  fill_gaps() %>% \r\n  gg_season(y = fish_count) +\r\n  labs(x = \"Month\", y = \"Count\",\r\n       title = \"Counts for Coho, Jack coho, and Steelhead at Willamette Falls, Oregon\",\r\n       subtitle = \"2001-2010\") +\r\n  theme_minimal() +\r\n  facet_wrap(~species_name, ncol = 1, scales = \"free\")\r\n\r\nseasons_plot\r\n\r\n\r\n\r\n\r\nFigure 2: Figure 2: Season plots showing trends for Coho, Jack coho, and Steelhead at the Willamette Falls fish ladder. Counts of individuals over a year time period are shown with each colored line representing data from one year. (Data: Columbia River DART)\r\n\r\n\r\n\r\nBoth Coho and Jack coho peak in counts for passage at the falls in October. There are little to no counts in other months.\r\nSteelhead have a longer time period of passing through the falls, from January to July, with a higher peak in the spring and early summer months.\r\nAnnual counts\r\n\r\n\r\nhide\r\n\r\n# wrangling to aggregate fish counts by year\r\nannual_counts <- fish_ts %>% \r\n  index_by(year = ~year(.)) %>% # groups observations by year\r\n  group_by(species_name) %>% # groups observations by species\r\n  summarize(total_count = sum(fish_count, na.rm = TRUE))  # counts observations per year by species\r\n\r\n\r\n#visualization of annual counts\r\n# ggplot(data = annual_counts, aes(x = year, y = total_count, fill = species_name)) +\r\n#   geom_col(show.legend = FALSE) +\r\n#   scale_fill_manual(values = c(\"coral4\", \"brown1\", \"steelblue4\")) +\r\n#   facet_wrap(~species_name) +\r\n#   theme_minimal() +\r\n#   labs(x = \"Year\", y = \"Counts\") +\r\n#   scale_x_continuous(breaks = c(2002, 2004, 2006, 2008, 2010)) +\r\n#   theme(axis.text.x = element_text(angle = 30)) +\r\n#   scale_y_continuous(labels = scales::comma)\r\n\r\n\r\nggplot(data = annual_counts, aes(x = year, y = total_count)) +\r\n  geom_line(aes(color = species_name), size = .75) +\r\n  scale_color_manual(values = c(\"coral4\", \"brown1\", \"steelblue4\")) +\r\n  theme_minimal() +\r\n  labs(x = \"Year\", y = \"Counts\", title = \"Annual counts of fish passage on the Willamette Falls\", subtitle = \"2001-2010\") +\r\n  theme(legend.title = element_blank()) +\r\n  scale_x_continuous(breaks = c(2002, 2004, 2006, 2008, 2010)) +\r\n  theme(axis.text.x = element_text(angle = 30)) +\r\n  scale_y_continuous(labels = scales::comma)\r\n\r\n\r\n\r\n\r\nFigure 3: Figure 3: Changes in annual salmon counts at the Willamette Falls fish ladder for Coho, Jack coho, and Steelhead between 2001 and 2010. (Data: Columbia River DART)\r\n\r\n\r\n\r\nJack coho’s have the lowest annual counts compared to the other two fish. Counts have remained relatively consistent across the years.\r\nCoho experienced an increase in observed counts beginning around 2008.\r\nSteelhead have the highest annual counts for the majority of the observation years. They have experienced some variability with spikes and declines between 2001-2006.\r\n\r\n\r\n\r\n",
    "preview": "posts/2022-03-12-willamette-falls-fish-passage-time-series-summary/files/willamette_river.jpg",
    "last_modified": "2022-03-12T13:43:53-08:00",
    "input_file": {}
  },
  {
    "path": "posts/2022-03-12-spatialdatavisualization/",
    "title": "Spatial Data Visualization",
    "description": "An exploration of California oil spills drawn from the CA DFW Oil Spill Incident Tracking dataset. An interactive map shows the location of oil spill events.",
    "author": [
      {
        "name": "Halley McVeigh",
        "url": {}
      }
    ],
    "date": "2022-03-07",
    "categories": [],
    "contents": "\r\n\r\n\r\nhide\r\n\r\nknitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)\r\n\r\n#packages to attach\r\nlibrary(tidyverse)\r\nlibrary(here)\r\nlibrary(sf)\r\nlibrary(janitor)\r\nlibrary(tmap)\r\n\r\n\r\n\r\nOverview: This is an exploration of California oil spills. The dataset is drawn from CA DFW Oil Spill Incident Tracking. An interactive map shows the location of oil spill events.\r\nAn “incident” is considered “a discharge or threatened discharge of petroleum or other deleterious material into the waters of the state.” The Office of Spill Prevention and Response (OSPR) Incident Tracking Database is a statewide oil spill tracking information system. The data are collected by OSPR Field Response Team members for Marine oil spills and by OSPR Inland Pollution Coordinators and Wardens for Inland incidents.\r\n\r\n\r\n\r\n",
    "preview": {},
    "last_modified": "2022-03-12T13:26:52-08:00",
    "input_file": {}
  },
  {
    "path": "posts/2022-02-22-parameter-estimation/",
    "title": "Parameter estimation",
    "description": "Non linear least squares to estimate parameters of a length to weight model for lizard populations in New Mexico",
    "author": [
      {
        "name": "Halley McVeigh",
        "url": {}
      }
    ],
    "date": "2022-02-22",
    "categories": [],
    "contents": "\r\n\r\n\r\nhide\r\n\r\nknitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)\r\n\r\nlibrary(here)\r\nlibrary(tidyverse)\r\nlibrary(purrr)\r\nlibrary(janitor)\r\nlibrary(broom)\r\nlibrary(kableExtra)\r\nlibrary(modelr)\r\n\r\n\r\n\r\n\r\n\r\nhide\r\n\r\nlizards <- read_csv(here(\"data\", \"lizard.csv\")) %>% \r\n  clean_names() %>% \r\n  drop_na()\r\n\r\n\r\n\r\nUsing non linear least squares to estimate parameters of a length to weight model for lizard populations in New Mexico.\r\nData source: [Lightfoot, D. and W.G. Whitford. 2020. Lizard pitfall trap data from 11 NPP study locations at the Jornada Basin LTER site, 1989-2006 ver 37. Environmental Data Initiative.] (https://doi.org/10.6073/pasta/4a6e258fb49c31e222ecbbcfd128967f)\r\n\\[\r\nW = a(SVL)^b\r\n\\]\r\nCreate a function for the above equation where W is the body weight and SVL is the snout-vent length of lizard populations in New Mexico:\r\n\r\n\r\nhide\r\n\r\nlizard_function <- function(a, sv_length, b){\r\n  W = a*sv_length^b\r\n  return(W)\r\n}\r\n\r\n\r\n\r\n\r\n\r\nhide\r\n\r\n# Using OLS to find b-intercept\r\n\r\nguess_df <- lizards %>% \r\n  mutate(log_weight = log(weight),\r\n         log_length = log(sv_length))\r\n\r\n# Create guess vectors and coefficient\r\nguess_vec <- lm(log_weight ~ log_length, data = guess_df)\r\nguess_coef <- coef(guess_vec)\r\n\r\nlizard_nls <- nls(weight ~ lizard_function(a, sv_length, b),\r\n                  data = lizards,\r\n                  start =\r\n                    list(a = 2.718^(guess_coef[1]/guess_coef[2]), b = guess_coef[2]),\r\n                  trace = TRUE)\r\n\r\n\r\n2.309002e+09 (3.87e+02): par = (0.0354286 2.537119)\r\n37258.38    (1.19e+00): par = (0.0003458817 2.536411)\r\n15903.55    (1.68e-01): par = (0.0003460121 2.464335)\r\n15467.24    (5.36e-03): par = (0.0003446173 2.451287)\r\n15466.81    (5.15e-04): par = (0.0003404191 2.45366)\r\n15466.80    (1.18e-04): par = (0.0003412931 2.453084)\r\n15466.80    (2.88e-05): par = (0.0003410855 2.453225)\r\n15466.80    (7.07e-06): par = (0.0003411367 2.453191)\r\n\r\nhide\r\n\r\nsummary(lizard_nls)\r\n\r\n\r\n\r\nFormula: weight ~ lizard_function(a, sv_length, b)\r\n\r\nParameters:\r\n   Estimate Std. Error t value Pr(>|t|)    \r\na 3.411e-04  3.995e-05   8.538   <2e-16 ***\r\nb 2.453e+00  2.698e-02  90.930   <2e-16 ***\r\n---\r\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\r\n\r\nResidual standard error: 2.792 on 1984 degrees of freedom\r\n\r\nNumber of iterations to convergence: 7 \r\nAchieved convergence tolerance: 7.067e-06\r\n\r\nPlot of lizard snout-vent length and body weight by sex with nls predicted\r\n\r\n\r\nhide\r\n\r\nsv_length_series <- seq(0, 150, by = 1) # for sv_length of 0-150 mm\r\n\r\npred <- predict(lizard_nls, list(sv_length = sv_length_series)) #predictions with model\r\n\r\nlizards_predicted <- data.frame(sv_length_series, pred) #combine predicted and series into data frame\r\n\r\n\r\n# Plot lizards data and predicted\r\n\r\nggplot(data = lizards) +\r\n  geom_point(aes(x = sv_length, y = weight, color = sex)) +\r\n  theme_minimal() +\r\n  labs(x = \"Snout-vent length (mm)\", y = \"Body weight (g)\",\r\n       title = \"Lizard snout-vent length and body weight by sex\",\r\n       subtitle = \"Predicted fitted model of lizards using non linear least squares shown in black\") +\r\n  geom_line(data = lizards_predicted, aes(x = sv_length_series, y = pred))\r\n\r\n\r\n\r\n\r\nFigure 1: Scatterplot showing the relationship between lizard snout-vent length (mm) and lizard body weight (g) of female (shown in pink) and male (shown in teal) lizards. A fitted model using non linear least squares of lizard predictions is shown in black. (Data: Lightfoot, D. and W.G. Whitford. 2020).\r\n\r\n\r\nhide\r\n\r\nlizards_nls_tidy <- broom::tidy(lizard_nls)\r\n\r\n\r\n\r\nTable 1: Non linear least square model parameters for terms a and b for the fitted model for lizard populations in New Mexico using snout-vent length and body weight.\r\n\r\n\r\nhide\r\n\r\nkable(lizards_nls_tidy, digits = 5) %>% \r\n  kable_styling(full_width = FALSE)\r\n\r\n\r\n\r\nterm\r\n\r\n\r\nestimate\r\n\r\n\r\nstd.error\r\n\r\n\r\nstatistic\r\n\r\n\r\np.value\r\n\r\n\r\na\r\n\r\n\r\n0.00034\r\n\r\n\r\n0.00004\r\n\r\n\r\n8.53845\r\n\r\n\r\n0\r\n\r\n\r\nb\r\n\r\n\r\n2.45319\r\n\r\n\r\n0.02698\r\n\r\n\r\n90.92964\r\n\r\n\r\n0\r\n\r\n\r\nFilter out a subset of male Western Whiptail (CNTI) (Cnemidophorus tigrisatus) lizards\r\n\r\n\r\nhide\r\n\r\n# Subset for male CNTI lizards\r\n\r\ncnti_male_lizards <- lizards %>% \r\n  filter(spp == 'CNTI') %>% \r\n  filter(sex == 'M')\r\n\r\n\r\n\r\n\r\n\r\nhide\r\n\r\n# Make a dataframe and log \r\n\r\ncnti_male_df <- cnti_male_lizards %>%\r\n  mutate(log_weight = log(weight),\r\n         log_length = log(sv_length))\r\n\r\nguess_male_vec <- lm(log_weight ~ log_length, data = cnti_male_df)\r\nguess_male_coef<- coef(guess_male_vec)\r\n\r\ncnti_male_nls <- nls(weight ~ lizard_function(a, sv_length, b),\r\n                  data = cnti_male_lizards,\r\n                  start = list(a=2.718^(guess_coef[1]/guess_coef[2]), b=guess_coef[2]),\r\n                  trace = TRUE)\r\n\r\n\r\n5.474817e+08 (8.24e+02): par = (0.0354286 2.537119)\r\n19591.36    (4.83e+00): par = (0.0004581057 2.535805)\r\n1527.440    (9.44e-01): par = (0.0004591616 2.434399)\r\n807.7503    (9.65e-03): par = (0.0005239172 2.371892)\r\n807.6761    (7.69e-04): par = (0.000532293 2.367968)\r\n807.6756    (2.34e-05): par = (0.0005314971 2.36833)\r\n807.6756    (2.17e-06): par = (0.0005315785 2.368296)\r\n\r\nhide\r\n\r\nsummary(cnti_male_nls)\r\n\r\n\r\n\r\nFormula: weight ~ lizard_function(a, sv_length, b)\r\n\r\nParameters:\r\n   Estimate Std. Error t value Pr(>|t|)    \r\na 0.0005316  0.0004288    1.24    0.219    \r\nb 2.3682962  0.1800347   13.15   <2e-16 ***\r\n---\r\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\r\n\r\nResidual standard error: 3.397 on 70 degrees of freedom\r\n\r\nNumber of iterations to convergence: 6 \r\nAchieved convergence tolerance: 2.172e-06\r\n\r\nPlot of lizard snout-vent length and body weight with nls predicted for male Western Whiptail (CNTI) (Cnemidophorus tigrisatus) lizards\r\n\r\n\r\nhide\r\n\r\ncnti_sv_length_series <- seq(0, 110, by = 1) # for sv_length of 0-110 mm\r\n\r\ncnti_pred <- predict(cnti_male_nls, list(sv_length = cnti_sv_length_series)) #predictions with model\r\n\r\ncnti_male_predicted <- data.frame(cnti_sv_length_series, cnti_pred) #combine predicted and series into data frame\r\n\r\n\r\n# Plot lizards data and predicted\r\n\r\nggplot(data = cnti_male_lizards) +\r\n  geom_point(aes(x = sv_length, y = weight), color = \"darkcyan\") +\r\n  theme_minimal() +\r\n  labs(x = \"Snout-vent length (mm)\", y = \"Body weight (g)\",\r\n       title = \"Male Western Whiptail lizards by snout-vent length and body weight\",\r\n       subtitle = \"With predicted fitted models using non linear least squares\") +\r\n  geom_line(data = cnti_male_predicted, aes(x = cnti_sv_length_series, y = cnti_pred)) +\r\n  geom_line(data = lizards_predicted, aes(x = sv_length_series, y = pred), color = \"darkred\") +\r\n  coord_cartesian(xlim = c(0, 105))\r\n\r\n\r\n\r\n\r\nFigure 2: Scatterplot showing the relationship between lizard snout-vent length (mm) and lizard body weight (g) of male (shown in teal) Western Whiptail lizards. A fitted model using non linear least squares of male Western Whiptail lizard predictions is shown in black. The fitted model using non linear least squares of all lizard predictions is shown in dark red. (Data: Lightfoot, D. and W.G. Whitford. 2020).\r\n\r\n\r\nhide\r\n\r\ncnti_male_nls_tidy <- broom::tidy(cnti_male_nls)\r\n\r\n\r\n\r\nTable 2: Non linear least square model parameters for terms a and b for the fitted model for male Western Whiptail lizards (Cnemidophorus tigrisatus) using snout-vent length and body weight.\r\n\r\n\r\nhide\r\n\r\nkable(cnti_male_nls_tidy, digits = 5) %>% \r\n  kable_styling(full_width = FALSE)\r\n\r\n\r\n\r\nterm\r\n\r\n\r\nestimate\r\n\r\n\r\nstd.error\r\n\r\n\r\nstatistic\r\n\r\n\r\np.value\r\n\r\n\r\na\r\n\r\n\r\n0.00053\r\n\r\n\r\n0.00043\r\n\r\n\r\n1.23969\r\n\r\n\r\n0.21923\r\n\r\n\r\nb\r\n\r\n\r\n2.36830\r\n\r\n\r\n0.18003\r\n\r\n\r\n13.15467\r\n\r\n\r\n0.00000\r\n\r\n\r\nApply both models to male Western Whiptail subset and compare RMSEs\r\n\r\n\r\nhide\r\n\r\nrmse <- function(x, y) {\r\n  rmse <- (x-y)^2 %>% mean() %>% sqrt()\r\n  return(rmse)\r\n}\r\n\r\ncnti_pred_rmse <- predict(cnti_male_nls, cnti_male_df)\r\n\r\nlizard_cnti_pred_rmse <- predict(lizard_nls, cnti_male_df)\r\n\r\nrmse_df <- data.frame(cnti_pred_rmse, lizard_cnti_pred_rmse, cnti_male_lizards)\r\n\r\nrmse_predict <- rmse_df %>% \r\n  summarize(rmse_lizard = rmse(weight, lizard_cnti_pred_rmse),\r\n            rmse_cnti = rmse(weight, cnti_pred_rmse)) %>% \r\n  rename(\r\n    'RMSE for full lizard population NLS model' = rmse_lizard,\r\n    'RMSE for CNTI lizard NLS model' = rmse_cnti\r\n  )\r\n\r\n\r\nkable(rmse_predict,\r\n    caption = \"Table of Root-Mean_Square Errors for Two Models when applied to male Western Whiptail lizard subset\", digits = 2) %>% \r\n  kable_styling(full_width = FALSE)\r\n\r\n\r\n\r\nTable 1: Table of Root-Mean_Square Errors for Two Models when applied to male Western Whiptail lizard subset\r\n\r\n\r\nRMSE for full lizard population NLS model\r\n\r\n\r\nRMSE for CNTI lizard NLS model\r\n\r\n\r\n3.56\r\n\r\n\r\n3.35\r\n\r\n\r\nTable 3: The RMSE values for the nonlinear least squares model fitted to the entire lizard population dataset and the model fitted to the male Western Whiptail lizard when applied to the male Western Whiptail lizard subset. The RMSE value for the subset data NLS is lower, indicating a better predictor model. This model better fits the subset data and should be used for male Western Whiptail lizards.\r\n\r\n\r\n\r\n",
    "preview": "posts/2022-02-22-parameter-estimation/parameter-estimation_files/figure-html5/unnamed-chunk-4-1.png",
    "last_modified": "2022-03-12T13:28:41-08:00",
    "input_file": {}
  },
  {
    "path": "posts/2022-02-21-exploratory-analaysis-of-sierra-amphibians/",
    "title": "Exploratory analaysis of Sierra amphibians",
    "description": "An exploration of amphibian abundance from the Sierra Lakes Inventory Project.",
    "author": [
      {
        "name": "Halley McVeigh",
        "url": {}
      }
    ],
    "date": "2022-02-21",
    "categories": [],
    "contents": "\r\n\r\n\r\nhide\r\n\r\nknitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)\r\n\r\nlibrary(tidyverse)\r\nlibrary(readxl)\r\nlibrary(here)\r\nlibrary(lubridate)\r\nlibrary(patchwork)\r\n\r\n\r\n\r\nThis task will involve wrangling data for Sierra amphibians and creating a compound data visualization figure. I will explore amphibian abundance data recorded by the Sierra Lakes Inventory Project (SLIP).\r\nData citation: Knapp,R.A., C. Pavelka, E.E. Hegeman, and T.C. Smith. 2020. The Sierra Lakes Inventory Project: Non-Native fish and community composition of lakes and ponds in the Sierra Nevada, California ver 2. Environmental Data Initiative. https://doi.org/10.6073/pasta/d835832d7fd00d9e4466e44eea87fab3\r\nRead in and wrangle the data\r\n\r\n\r\nhide\r\n\r\n# Read in amphibian data\r\n\r\namphibians <- readxl::read_xlsx(here(\"data\", \"sierra_amphibians.xlsx\"))\r\n\r\nrana_muscosa <- amphibians %>% \r\n  filter(amphibian_species == \"RAMU\") %>% #filter to include only mountain yellow-legged frog\r\n  filter(amphibian_life_stage == c(\"SubAdult\", \"Tadpole\", \"Adult\")) %>% \r\n  mutate(date = ymd(survey_date)) #convert date to date format\r\n\r\nrana_muscosa$date <- as.numeric(format(rana_muscosa$date, \"%Y\"))  #extract just the year\r\n  \r\nrana_muscosa_summary <- rana_muscosa %>% \r\n  group_by(date, amphibian_life_stage) %>%  #group by year and life stage\r\n  summarize(frog_count = sum(amphibian_number, na.rm = TRUE)) #and summarize counts of frogs\r\n\r\n\r\n\r\nGraph #1: Plot of adult, subadult, and tadpole mountain yellow-legged frog counts by life stage\r\n\r\n\r\nhide\r\n\r\n#create ggplot of counts, facet wrapped by life stage\r\ngraph1 <- ggplot(data = rana_muscosa_summary, aes(x = date, y = frog_count, color = amphibian_life_stage)) +\r\n  geom_point() +\r\n  geom_line() +\r\n  theme_minimal() +\r\n  labs(title = \"Mountain Yellow-Legged Frog Counts from 1995 to 2002\",\r\n       x = \"Year\",\r\n       y= \"Count\",\r\n       color = \"Life Stage\") +\r\n  facet_wrap(~amphibian_life_stage) +\r\n  theme(legend.position = \"none\")\r\n\r\ngraph1\r\n\r\n\r\n\r\n\r\nGraph #2: Plot combining adult and subadult mountain yellow-legged frog counts observed in 5 lakes with greatest total observed counts\r\n\r\n\r\nhide\r\n\r\namphibians$lake_id <-as.character(as.numeric(amphibians$lake_id))\r\n\r\nrana_muscosa_top5 <- amphibians %>% \r\n  filter(amphibian_life_stage %in% c(\"SubAdult\", \"Adult\")) %>% #filter to include only adult and subadult frogs (no tadpoles)\r\n  filter(amphibian_location == \"in lake\") %>% #only include frogs observed in the lake\r\n  filter(amphibian_species == \"RAMU\") %>% #filter for rana muscosa species\r\n  group_by(lake_id) %>% \r\n  summarize(rana_muscosa_count = sum(amphibian_number)) %>%  #total frog counts per each lake\r\n  mutate(lake_id = fct_reorder(lake_id, rana_muscosa_count)) %>% #arrange in descending order\r\n  slice_max(rana_muscosa_count, n=5) #keep top 5 highest values of frog counts per lake\r\n\r\nrana_muscosa_top5$lake_id = paste('Lake', rana_muscosa_top5$lake_id, sep = ' ')#%>%\r\n  #mutate(lake_id = fct_reorder(lake_id, rana_muscosa_count))\r\n  \r\n# create ggplot\r\ngraph2 <- ggplot(data= rana_muscosa_top5, aes(x=reorder(lake_id, -rana_muscosa_count), y=rana_muscosa_count)) +\r\n  geom_col(fill = \"cyan4\", color = \"black\") +\r\n  labs(title = \"Top 5 lakes with the greatest counts of Mountain yellow-legged adult and subadult frogs\", \r\n       x= \"Lake ID\",\r\n       y = \"Count (adults and subadults)\") +\r\n  theme_minimal() +\r\n  coord_flip()\r\n\r\ngraph2\r\n\r\n\r\n\r\n\r\nCombine both plots into a compound figure using patchwork package\r\n\r\n\r\nhide\r\n\r\ngraph1 + graph2 + plot_layout(ncol = 1, heights = c(2,2)) #combining graph 1 and graph 2 on the same figure\r\n\r\n\r\n\r\n\r\nFigure 1: Figure 1. Top: The change in Mountain Yellow-Legged Frog counts from 1995 to 2002 for different life stages - adults, subadults and tadpoles. Bottom: The top 5 lakes with the highest counts of adult and subadult Mountain Yellow-Legged Frogs.\r\n\r\n\r\n\r\n\r\n\r\n\r\n",
    "preview": "posts/2022-02-21-exploratory-analaysis-of-sierra-amphibians/exploratory-analaysis-of-sierra-amphibians_files/figure-html5/unnamed-chunk-2-1.png",
    "last_modified": "2022-03-12T13:27:34-08:00",
    "input_file": {}
  }
]
